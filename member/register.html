<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet"> -->
    <link rel="stylesheet" href="./css/register.css">
    <link rel="stylesheet" href="./iconfont/iconfont.css">
    <script>
        window.onload = function(){
            var oEmail = document.getElementById("email");
            var oUser = document.getElementById("userReg");
            var oEmailReg = document.getElementById("emailReg");
            var User = document.getElementById("user");
            oEmail.onclick = function(){
                oUser.style.display = "none";
                oEmailReg.style.display = "block";
                oEmail.className = "active";
                User.className = "";
            }
            User.onclick = function(){
                oUser.style.display = "block";
                oEmailReg.style.display = "none";
                User.className = "active";
                oEmail.className = "";
            }
        }
    </script>
</head>
<body>
    <!-- 导航  -->
    <header>
        <div class="tHeader">
            <div class="topHeader">
                <div class="leftTop">
                    <ul>
                        <li>
                            <a href="./login.html">登录</a>
                            <span>|</span>
                        </li>
                        <li>
                            <a href="">注册</a>
                            <span>|</span>
                        </li>
                        <li>
                            <a href="">移动端下载</a>
                            <span>|</span>
                        </li>
                        <li>
                            <a href="">卖家移动端下载</a>
                        </li>
                    </ul>
                </div>
                <div class="rightTop">
                    <ul>
                        <li>
                            <a href="http://localhost:8888/index.html">商城首页</a>
                            <span>|</span>
                        </li>
                        <li>
                            <a href="">我的订单</a>
                            <span>|</span>
                        </li>
                        <li>
                            <a href="">开店申请</a>
                            <span>|</span>
                        </li>
                        <li>
                            <a href="">注册分销商</a>
                            <span>|</span>
                        </li>
                        <li>
                            <a href="">
                                <i class="iconfont icon-shoucang collect"></i>我的收藏
                            </a>
                            <span>|</span>
                        </li>
                        <li>
                            <a href="">
                                <i class="iconfont icon-05 service"></i>客服中心
                            </a>
                            <span>|</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="headerImg">
            <div class="left_img">
                <a href="">
                    <img src="https://gelimall.oss-cn-shenzhen.aliyuncs.com/album/2020/4/2/86f141a8-3876-4568-86f0-3c343430775c.gif" alt="">
                </a>
            </div>
            <div class="right_img">
                <p>
                    <i>|</i>
                    欢迎注册
                </p>
            </div>
        </div>
    </header>
    <main>
        <div class="tabTitle">
            <ul>
                <li class="active" id="user">用户注册</li>
                <li id="email">邮箱注册</li>
            </ul>
        </div>
        <div class="tabBox" >
            <div class="tabForm" id="userReg">
                <ul>
                    <li>
                        <span>*手机</span>
                        <div class="textfield">
                            <input type="text" name="phone" id="phone" placeholder="请输入手机">
                            <i class="iconfont icon-shouji"></i>
                        </div>
                    </li>
                    <li>
                        <span>*请设置密码</span>
                        <div class="textfield">
                            <input type="text" placeholder="请输入密码" name="password">
                            <i class="iconfont icon-mima"></i>
                        </div>
                    </li>
                    <li>
                        <span>*请确认密码</span>
                        <div class="textfield">
                            <input type="text" name="" id="" placeholder="请再次输入密码" name="repassword">
                            <i class="iconfont icon-mima"></i>
                        </div>  
                    </li>
                    <li>
                        <span>*验证码</span>
                        <div class="textfield">
                            <input type="text" name="" id="code" placeholder="请输入验证码">
                            <i id="verify">1234</i>
                        </div>
                    </li>
                    <li>
                        <p>
                            <input type="checkbox" checked>
                            同意<a href="">《格力官方商城用户注册协议》</a>和<a href="">《隐私声明》</a>
                        </p>
                    </li>
                    <li>
                        <button id="btn">同意协议并注册</button>
                    </li>
                </ul>
            </div>
            <div class="emailReg" id="emailReg">
                <ul>
                    <li>
                        <span>*用户名</span>
                        <div class="textfield">
                            <input type="text" name="username" id="" placeholder="请输入用户名">
                            <i class="iconfont icon-geren"></i>
                        </div>
                    </li>
                    <li>
                        <span>*邮箱</span>
                        <div class="textfield">
                            <input type="text" name="" id="" placeholder="请输入邮箱">
                            <i class="iconfont icon-youxiang"></i>
                        </div>
                    </li>
                    <li>
                        <span>*手机</span>
                        <div class="textfield">
                            <input type="text" name="" id="" placeholder="请输入手机">
                            <i class="iconfont icon-shouji"></i>
                        </div>
                    </li>
                    <li>
                        <span>*请设置密码</span>
                        <div class="textfield">
                            <input type="text" name="" id="" placeholder="请输入密码">
                            <i class="iconfont icon-mima"></i>
                        </div>
                    </li>
                    <li>
                        <span>*请确认密码</span>
                        <div class="textfield">
                            <input type="text" name="" id="" placeholder="请再次输入用户名">
                            <i class="iconfont icon-mima"></i>
                        </div>
                    </li>
                    <li>
                        <span>*验证码</span>
                        <div class="textfield">
                            <input type="text" name="" id="" placeholder="请输入验证码">
                            <i></i>
                        </div>
                    </li>
                    <li>
                        <p>
                            <input type="checkbox">
                            同意<a href="">《格力官方商城用户注册协议》</a>和<a href="">《隐私声明》</a>
                        </p>
                        <p class="check">请核对邮箱准确性，注册成功后需要登录邮箱激活账号才能够登录。</p>
                    </li>
                    <li>
                        <button id="btn">同意协议并注册</button>
                    </li>
                </ul>  
            </div>
        </div>
        <div class="alertBox" id="alertBox">
            注册成功
        </div>
    </main> 
    <footer id="footer">
        <div class="footerBottom">
            <div class="question">
                <ul>
                    购物指南
                    <li><a>格力境外购买须知</a></li>
                    <li><a>免责声明</a></li>
                </ul>
                <ul>
                    售后服务
                    <li><a href="">服务生效</a></li>
                    <li><a href="">安装/维修</a></li>
                </ul>
                <ul>
                    常见问题
                    <li><a href="">空调内机条码获取方法</a></li>
                    <li><a href="">订单常见问题说明</a></li>
                    <li><a href="">空调常见问题说明</a></li>
                    <li><a href="">冰箱常见问题说明</a></li>
                </ul>
                <ul>
                    联系我们
                    <li><a href="">联系我们</a></li>
                </ul>
                <ul>
                    服务查询
                    <li><a href="">配送服务查询</a></li>
                </ul>
                <ul>
                    商城支付
                    <li><a href="">商城支付</a></li>
                </ul>
            </div>
            <div class="bottom">
                <p>珠海格力电器股份有限公司版权所有 粤ICP备05006515号</p>
                <img src="./images/footer_04.png" alt="">
            </div>
        </div>
    </footer>
</body>
<script type="module">
    import ajax from "./ajax.js";
    var oBtn = document.getElementById("btn");
    var oInput = document.querySelectorAll(".textfield input");
    var oAlert = document.getElementById("alertBox");
    var phone = document.getElementById('phone');
    var oVerify = document.getElementById("verify");
    var code = document.getElementById("code");

    phone.onblur = function(){
        var value = phone.value;
       if(!(/^1(3|4|5|6|7|8|9)\d{9}$/.test(value))){
           alert("请输入正确的手机号码");
       }else{
        //    alert("手机号正确,请继续");
        return;
       }
    }

    function numTest(n){
           var str = "";
           for(var i = 0; i < n; i++){
               var tmp = parseInt(Math.random() * 123);
               if(tmp > 0 && tmp < 9){
                    str += tmp;
               }else if(tmp >= 65 && tmp <= 90 || tmp >= 97 && tmp <= 122){
                   str += String.fromCharCode(tmp);
               }else{
                   i--;
               }
           }
           return str;
    }
    oVerify.innerHTML = numTest(4);
    code.onfocus = function(){
        // numTest(4);
        oVerify.innerHTML = numTest(4);
    }

    oBtn.onclick = function(){
        var oValue = code.value;
        if(oValue == ""){
            alert("请输入验证码");
        }

        ajax({
            type:"post",
            url:"register.php",
            data:{
                username:oInput[0].value,
                password:oInput[1].value,
                repassword:oInput[2].value,
                createTime: new Date().getTime()
            },
            success: function(msg){
                // console.log(msg);
                var obj = JSON.parse(msg);
                if(obj.code){
                    oAlert.style.display = "block";
                    // alert("注册成功");
                }else{
                    
                    oAlert.innerHTML = "注册失败";
                    oAlert.style.display = "block";
                    // alert("注册失败")
                }
                oAlert.style.display = "block";
                oAlert.innerHTML = obj.msg;
            },
            error:function(msg){
                console.log(msg);
            }
        })
        document.onclick = function(){
            oAlert.style.display = "none";
        }

        
    }
</script>
</html>